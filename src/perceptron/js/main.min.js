var brain,inputs=[],points=Array(100),trainIndex=0;function setup(){createCanvas(500,500);brain=new Perceptron(3);for(var a=0;a<points.length;a++)points[a]=new Point}
function draw(){background(255);stroke(0);var a=new Point(-1,f(-1)),b=new Point(1,f(1));line(a.pixelX(),a.pixelY(),b.pixelX(),b.pixelY());a=new Point(-1,brain.guessY(-1));b=new Point(1,brain.guessY(1));line(a.pixelX(),a.pixelY(),b.pixelX(),b.pixelY());points.forEach(function(a){a.show();var b=a.label;brain.guess([a.x,a.y,a.bias])==b?fill(0,255,0):fill(255,0,0);noStroke();ellipse(a.pixelX(),a.pixelY(),8,8)});a=points[trainIndex];brain.train([a.x,a.y,a.bias],a.label);trainIndex++;trainIndex==points.length&&
(trainIndex=0)}function mousePressed(){}var Perceptron=function(a){this.weights=Array(a);this.lr=.01;for(a=0;a<this.weights.length;a++)this.weights[a]=random(-1,1);this.guess=function(a){for(var b=0,d=0;d<this.weights.length;d++)b+=a[d]*this.weights[d];return 0<=b?1:-1};this.train=function(a,e){for(var b=this.guess(a),b=e-b,c=0;c<this.weights.length;c++)this.weights[c]+=b*a[c]*this.lr};this.guessY=function(a){var b=this.weights[1];return-(this.weights[2]/b)-this.weights[0]/b*a}};
function Point(a,b){this.x=a||random(-1,1);this.y=b||random(-1,1);this.label;this.bias=1;var e=f(this.x);this.label=this.y>e?1:-1;this.pixelX=function(){return map(this.x,-1,1,0,width)};this.pixelY=function(){return map(this.y,-1,1,height,0)};this.show=function(){stroke(0);1==this.label?fill(255):fill(0);var a=this.pixelX(),b=this.pixelY();ellipse(a,b,16,16)}}function f(a){return.3*a+.2};
