var NeuronalNetwork=function(a,f,d){this.input_nodes=a;this.hidden_nodes=f;this.output_nodes=d;this.weight_ih=new Matrix(this.hidden_nodes,this.input_nodes);this.weight_ho=new Matrix(this.output_nodes,this.hidden_nodes);this.weight_ih.randomize();this.weight_ho.randomize();this.bias_h=new Matrix(this.hidden_nodes,1);this.bias_o=new Matrix(this.output_nodes,1);this.bias_h.randomize();this.bias_o.randomize();this.lerning_rate=.1};
NeuronalNetwork.prototype.setLearningRate=function(a){this.learning_rate=a};NeuronalNetwork.prototype.predict=function(a){a=Matrix.fromArray(a);a=Matrix.multiply(this.weight_ih,a);a.add(this.bias_h);a.map(this.sigmoid);a=Matrix.multiply(this.weight_ho,a);a.add(this.bias_o);a.map(this.sigmoid);return a.toArray()};
NeuronalNetwork.prototype.train=function(a,f){var d=Matrix.fromArray(a),c=Matrix.multiply(this.weight_ih,d);c.add(this.bias_h);c.map(this.sigmoid);var b=Matrix.multiply(this.weight_ho,c);b.add(this.bias_o);b.map(this.sigmoid);var e=Matrix.fromArray(f),e=Matrix.substract(e,b),b=Matrix.map(b,this.dsigmoid);b.multiply(e);b.multiply(this.lerning_rate);var g=Matrix.transpose(c),g=Matrix.multiply(b,g);this.weight_ho.add(g);this.bias_o.add(b);b=Matrix.transpose(this.weight_ho);e=Matrix.multiply(b,e);c=Matrix.map(c,
this.dsigmoid);c.multiply(e);c.multiply(this.lerning_rate);d=Matrix.transpose(d);d=Matrix.multiply(c,d);this.weight_ih.add(d);this.bias_h.add(c)};NeuronalNetwork.prototype.sigmoid=function(a){return 1/(1+Math.exp(-a))};NeuronalNetwork.prototype.dsigmoid=function(a){return a*(1-a)};
